{"ast":null,"code":"import axios from \"axios\";\nimport { useState } from \"react\";\nimport { Navigate } from \"react-router\";\nconst [userData, setUserData] = useState({\n  token: undefined\n});\nconst register = user => {\n  const {\n    name,\n    email,\n    password\n  } = {\n    ...user\n  };\n  return axios.post(\"http://localhost:8081/Register\", {\n    name,\n    email,\n    password\n  });\n};\n\n//\nconst login = async user => {\n  const {\n    email,\n    password\n  } = {\n    ...user\n  };\n  return axios.post(\"http://localhost:8081/login\", {\n    email,\n    password\n  }, {\n    withCredentials: true\n  }).then(response => {\n    if (response.data.sessUser) {\n      console.log(response.data);\n      localStorage.setItem(\"user\", JSON.stringify(response.data.sessUser));\n    }\n    return response.data;\n  });\n};\n\n//\nconst logout = async () => {\n  return axios.post(\"http://localhost:8081/logout\", {}, {\n    withCredentials: true\n  }).then(response => {\n    localStorage.removeItem(\"user\");\n    return response.data;\n  });\n};\n\n//\n\nconst checkLoggedIn = async () => {\n  let token = localStorage.getItem(\"user\");\n  if (token === \"\") {\n    localStorage.setItem(\"user\", \"\");\n    token = \"\";\n    //  return <Navigate to =\"/Login\"/>\n  }\n\n  const tokenResponse = await axios.post('http://localhost:8081/tokenIsValid', null, {\n    headers: {\n      \"x-auth-token\": token\n    }\n  });\n  if (tokenResponse.data) {\n    const userRes = await axios.get(\"http://localhost:8081/\", {\n      headers: {\n        \"user\": token\n      }\n    });\n    setUserData({\n      token,\n      user: userRes.data\n    });\n  }\n};\nconst AuthService = {\n  register,\n  login,\n  logout,\n  checkLoggedIn\n};\nexport default AuthService;","map":{"version":3,"names":["axios","useState","Navigate","userData","setUserData","token","undefined","register","user","name","email","password","post","login","withCredentials","then","response","data","sessUser","console","log","localStorage","setItem","JSON","stringify","logout","removeItem","checkLoggedIn","getItem","tokenResponse","headers","userRes","get","AuthService"],"sources":["E:/Projects/MernDemo/frontend/src/services/authservice.js"],"sourcesContent":["import axios from \"axios\";\r\nimport { useState } from \"react\";\r\nimport { Navigate } from \"react-router\";\r\n\r\nconst [ userData, setUserData] = useState({\r\n  token: undefined,\r\n});\r\n\r\n\r\nconst register = (user) => {\r\n  const { name, email, password } = { ...user };\r\n  return axios.post(\"http://localhost:8081/Register\", {\r\n    name,\r\n    email,\r\n    password,\r\n  });\r\n};\r\n\r\n//\r\nconst login = async (user) => {\r\n  const { email, password } = { ...user };\r\n  return axios\r\n    .post(\r\n      \"http://localhost:8081/login\",\r\n      {\r\n        email,\r\n        password,\r\n      },\r\n      { withCredentials: true }\r\n    )\r\n    .then((response) => {\r\n      if (response.data.sessUser) {\r\n        console.log(response.data);\r\n        localStorage.setItem(\"user\", JSON.stringify(response.data.sessUser));\r\n      }\r\n      return response.data;\r\n    });\r\n};\r\n\r\n//\r\nconst logout = async () => {\r\n  \r\n  return axios.post(\"http://localhost:8081/logout\",{},{ withCredentials: true}).then((response) => {\r\n    localStorage.removeItem(\"user\");\r\n    return response.data;\r\n  });\r\n};\r\n\r\n//\r\n\r\n\r\nconst checkLoggedIn = async () => {\r\n  let token = localStorage.getItem(\"user\");\r\n  if(token === \"\"){\r\n    localStorage.setItem(\"user\", \"\");\r\n    token = \"\";\r\n  //  return <Navigate to =\"/Login\"/>\r\n  }\r\n\r\n  const tokenResponse = await axios.post('http://localhost:8081/tokenIsValid', null, {headers: {\"x-auth-token\": token}});\r\n  if (tokenResponse.data) {\r\n    const userRes = await axios.get(\"http://localhost:8081/\", {\r\n      headers: { \"user\": token },\r\n    });\r\n    setUserData({\r\n      token,\r\n      user: userRes.data,\r\n    });\r\n  }\r\n}\r\n\r\nconst AuthService = {\r\n  register,\r\n  login,\r\n  logout,\r\n  checkLoggedIn,\r\n};\r\n\r\nexport default AuthService;\r\n"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,QAAQ,QAAQ,OAAO;AAChC,SAASC,QAAQ,QAAQ,cAAc;AAEvC,MAAM,CAAEC,QAAQ,EAAEC,WAAW,CAAC,GAAGH,QAAQ,CAAC;EACxCI,KAAK,EAAEC;AACT,CAAC,CAAC;AAGF,MAAMC,QAAQ,GAAIC,IAAI,IAAK;EACzB,MAAM;IAAEC,IAAI;IAAEC,KAAK;IAAEC;EAAS,CAAC,GAAG;IAAE,GAAGH;EAAK,CAAC;EAC7C,OAAOR,KAAK,CAACY,IAAI,CAAC,gCAAgC,EAAE;IAClDH,IAAI;IACJC,KAAK;IACLC;EACF,CAAC,CAAC;AACJ,CAAC;;AAED;AACA,MAAME,KAAK,GAAG,MAAOL,IAAI,IAAK;EAC5B,MAAM;IAAEE,KAAK;IAAEC;EAAS,CAAC,GAAG;IAAE,GAAGH;EAAK,CAAC;EACvC,OAAOR,KAAK,CACTY,IAAI,CACH,6BAA6B,EAC7B;IACEF,KAAK;IACLC;EACF,CAAC,EACD;IAAEG,eAAe,EAAE;EAAK,CAAC,CAC1B,CACAC,IAAI,CAAEC,QAAQ,IAAK;IAClB,IAAIA,QAAQ,CAACC,IAAI,CAACC,QAAQ,EAAE;MAC1BC,OAAO,CAACC,GAAG,CAACJ,QAAQ,CAACC,IAAI,CAAC;MAC1BI,YAAY,CAACC,OAAO,CAAC,MAAM,EAAEC,IAAI,CAACC,SAAS,CAACR,QAAQ,CAACC,IAAI,CAACC,QAAQ,CAAC,CAAC;IACtE;IACA,OAAOF,QAAQ,CAACC,IAAI;EACtB,CAAC,CAAC;AACN,CAAC;;AAED;AACA,MAAMQ,MAAM,GAAG,YAAY;EAEzB,OAAOzB,KAAK,CAACY,IAAI,CAAC,8BAA8B,EAAC,CAAC,CAAC,EAAC;IAAEE,eAAe,EAAE;EAAI,CAAC,CAAC,CAACC,IAAI,CAAEC,QAAQ,IAAK;IAC/FK,YAAY,CAACK,UAAU,CAAC,MAAM,CAAC;IAC/B,OAAOV,QAAQ,CAACC,IAAI;EACtB,CAAC,CAAC;AACJ,CAAC;;AAED;;AAGA,MAAMU,aAAa,GAAG,YAAY;EAChC,IAAItB,KAAK,GAAGgB,YAAY,CAACO,OAAO,CAAC,MAAM,CAAC;EACxC,IAAGvB,KAAK,KAAK,EAAE,EAAC;IACdgB,YAAY,CAACC,OAAO,CAAC,MAAM,EAAE,EAAE,CAAC;IAChCjB,KAAK,GAAG,EAAE;IACZ;EACA;;EAEA,MAAMwB,aAAa,GAAG,MAAM7B,KAAK,CAACY,IAAI,CAAC,oCAAoC,EAAE,IAAI,EAAE;IAACkB,OAAO,EAAE;MAAC,cAAc,EAAEzB;IAAK;EAAC,CAAC,CAAC;EACtH,IAAIwB,aAAa,CAACZ,IAAI,EAAE;IACtB,MAAMc,OAAO,GAAG,MAAM/B,KAAK,CAACgC,GAAG,CAAC,wBAAwB,EAAE;MACxDF,OAAO,EAAE;QAAE,MAAM,EAAEzB;MAAM;IAC3B,CAAC,CAAC;IACFD,WAAW,CAAC;MACVC,KAAK;MACLG,IAAI,EAAEuB,OAAO,CAACd;IAChB,CAAC,CAAC;EACJ;AACF,CAAC;AAED,MAAMgB,WAAW,GAAG;EAClB1B,QAAQ;EACRM,KAAK;EACLY,MAAM;EACNE;AACF,CAAC;AAED,eAAeM,WAAW"},"metadata":{},"sourceType":"module","externalDependencies":[]}